<svg:svg xmlns:svg='http://www.w3.org/2000/svg' xmlns='http://www.kite9.org/schema/adl' xmlns:xlink="http://www.w3.org/1999/xlink">
  <svg:defs>
    <svg:linearGradient id='risk-background' x1='0%' x2='0%' y1='0%' y2='100%'>
      <svg:stop offset='0%' stop-color='#FFF' />
      <svg:stop offset='100%' stop-color='#DDD' />
    </svg:linearGradient>

    <svg:filter id="dropshadow" height="130%">
      <svg:feGaussianBlur in="SourceAlpha" stdDeviation="1" />
      <svg:feOffset dx="2" dy="2" />
      <svg:feColorMatrix type="matrix" values="0 0 0 0 .5
                0 0 0 0 .5
                0 0 0 0 .5
                0 0 0 1 0" />
      <svg:feMerge>
        <svg:feMergeNode />
        <svg:feMergeNode in="SourceGraphic" />
      </svg:feMerge>
    </svg:filter>

    <svg:marker id="arrow-end-marker" markerWidth="7" markerHeight="7" refX="6" refY="4" orient="auto">
      <svg:path d="M2,2 L6,4 L2,6" class="arrow-marker"></svg:path>
    </svg:marker>

    <svg:marker id="arrow-start-marker" markerWidth="7" markerHeight="7" refX="2" refY="4" orient="auto">
      <svg:path d="M6,2 L2,4 L6,6" class="arrow-marker"></svg:path>
    </svg:marker>

    <svg:marker id="circle-marker" markerWidth="6" markerHeight="6" refX="3" refY="3">
      <svg:circle cx="3" cy="3" r="2" class="circle-marker"></svg:circle>
    </svg:marker>

  </svg:defs>
  
   <template id="generic" k9-ui="drag delete align connect autoconnect edit" k9-palette="insert">
    <risk-box>
      <code>
        <contents xpath="$template-1" type="string" />
      </code>
      <image style="kite9-vertical-align: center; kite9-min-size: 50px 50px;">
        <svg:image x="0" y="0" width="50px" height="50px" xlink:href="#{$template-2}" />
      </image>
      <title>
        <contents />
      </title>
    </risk-box>
  </template>
  
  <template id="fixed" k9-ui="drag delete align connect autoconnect" k9-palette="insert">
    <risk-box>
      <code>
        <contents xpath="$template-1" type="string" />
      </code>
      <image style="kite9-vertical-align: center; kite9-min-size: 50px 50px;">
        <svg:image x="0" y="0" width="50px" height="50px" xlink:href="#{$template-2}" />
      </image>
      <title>
        <contents xpath="$template-3" type="string"/>
      </title>
    </risk-box>
  </template>
  
  <template id="group" k9-ui="drag drop delete insert align connect layout invisible">
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg; fill: white; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='12px' ry='12px'  />
    </back>
    <contents />
  </template>

  <template id='context' k9-ui="drag drop delete insert align connect layout" k9-palette="insert">
    <contents />
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg;  '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='12px' ry='12px' class="context-back" />
    </back>
  </template>

  <template id='context-dotted' k9-ui="drag drop delete insert align connect layout">
    <contents />
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg;  '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' class="context-dotted" />
    </back>
  </template>

  <template id='container-label' k9-ui="delete orphan">
    <svg:g k9-indicator="rect" class="container-label-front">
      <front style="kite9-type: text; ">
        <contents />
      </front>
    </svg:g>
  </template>

  <template id='glyph-circle' k9-ui="drag drop delete insert align connect layout autoconnect">
   <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg; '>
	    <svg:ellipse rx='20' ry='20' cy='20' cx='20' stroke-width="1px" style='fill: url(#risk-background); '  class="glyph-back"/>
    </back>
  </template>
  
  <template id='glyph-rect' k9-ui="drag drop delete insert align connect layout autoconnect">
    <back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' style='fill: url(#risk-background); ' class="glyph-back" />
    </back>
    <svg:g class="glyph">
      <text style="kite9-type: text;">d</text>
    </svg:g>
  </template>

  <template id='glyph' k9-ui="drag drop delete insert align connect layout autoconnect">
    <back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='8px' ry='8px' style='fill: url(#risk-background); ' class="glyph-back" />
    </back>
    <svg:g class="glyph">
      <contents />
    </svg:g>
  </template>
  
  <template id="action" k9-ui="drag drop delete insert align connect layout autoconnect edit" k9-palette="insert">
    <back style='kite9-usage: decal; kite9-type: svg; fill: url(#risk-background); stroke: black; stroke-width: 1px;' k9-indicator="rect">
      <svg:polygon points='0 0, #{$width - 15} 0, #{$width} #{$height div 2}, #{$width - 15 } #{$height}, 0 #{$height}'  />
    </back>
    <front style="kite9-usage: regular; kite9-type: container; kite9-layout: down; 	kite9-padding: 10px; kite9-padding-right: 40px; ">
      <title>
      	<contents />
      </title>
    </front>
  </template>
  
  <template id="action-left" k9-ui="drag drop delete insert align connect layout autoconnect edit" k9-palette="insert">
    <back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:polygon points='0 #{$height div 2}, 15 0, #{$width} 0, #{$width} #{$height}, 15 #{$height} 0, #{$height div 2}' style='fill: url(#risk-background); stroke: black; stroke-width: 1px;' />
    </back>
    <front style="kite9-usage: regular; kite9-type: container; kite9-layout: down; 	kite9-padding: 10px; kite9-padding-left: 40px; ">
      <title>
      	<contents />
      </title>
    </front>
  </template>
  
  <template id="artifact" k9-ui="drag drop delete insert align connect layout autoconnect">
    <image style="kite9-vertical-align: center; kite9-min-size: 80px 80px;">
        <svg:image x="0" y="0" width="80px" height="80px" xlink:href="#{$template-1}" />
    </image>
    <title><contents /></title>
  </template>
  
  <template id='mitigated' k9-ui="drag delete align connect layout autoconnect">
    <contents />
    <back style='kite9-usage: decal; kite9-type: svg;  '>
      <svg:line x1="0" y1="#{$height}" x2="#{$width}" y2="0" stroke="black" stroke-width="10px" stroke-opacity="0.2"/>
    </back>
  </template>
  
  <template id='hidden' k9-ui="drag delete align connect layout autoconnect">
    <contents />
    <back style='kite9-usage: decal; kite9-type: svg; kite9-transform: position;'>
      <svg:g transform="scale(#{$width div 230}) translate(140,-20)" style="fill-opacity: 0.2;  kite9-template: url(/public/examples/risk-first/redesign/decals/hidden_risk_v2.svg);" />
	</back>
  </template>
  
  <template id="glyph-label-text" k9-ui="orphan text">
      <text-label style="kite9-type: text;" >
        <contents />
      </text-label>
  </template>

  <template id="glyph-stereotype-text" k9-ui="orphan text">
    <svg:g class="glyph-stereotype-text">
      <text-label style="kite9-type: text;">
        <contents />
      </text-label>
    </svg:g>
  </template>

  <template id="generic-text" k9-ui="orphan text">
    <text-label style="kite9-type: text;" class="generic-text">
      <contents />
    </text-label>
  </template>

  <template id='arrow' k9-ui="drag autoconnect align delete cascade connect">
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg; ' class="arrow-back">
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='4px' ry='4px'  />
    </back>
    <contents />
  </template>

  <template id="arrow-label-text" k9-ui="edit orphan">
    <contents />
  </template>

  <template id="link" k9-ui="delete">
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;" class="link" k9-indicator="path">
      <svg:path d="#{$path}" style="marker-start: #{$markerstart}; marker-end: #{$markerend}" />
    </link-body>
  </template>

  <template id="align" k9-ui="delete align invisible">
    <contents />
    <body style="kite9-type: svg; kite9-usage: decal;"  k9-indicator="path">
      <svg:path d="#{$path}" style="stroke-dasharray: 8; fill: none;" />
    </body>
  </template>

  <template id="grey-link" k9-ui="delete">
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;">
      <svg:path d="#{$path}" class="grey-link" style="marker-start: #{$markerstart}; marker-end: #{$markerend}" />
    </link-body>
  </template>

  <template id="thick-link" k9-ui="delete">
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;">
      <svg:path d="#{$path}" class="link" style="marker-start: #{$markerstart}; marker-end: #{$markerend}; stroke-width: 4px;" />
    </link-body>
  </template>
    
  <template id="dotted-link" k9-ui="delete">
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;">
      <svg:path d="#{$path}" class="link" style="marker-start: #{$markerstart}; marker-end: #{$markerend}; stroke-dasharray: 4;" />
    </link-body>
  </template>

  <template id="invisible-link">
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;">
      <svg:path d="#{$path}" class="" style="marker-start: #{$markerstart}; marker-end: #{$markerend}" />
    </link-body>
  </template>

  <template id='empty-terminator'>
    <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' style='fill: none; stroke: none ' />
  </template>

  <template id="tick">
    <tickbox style='kite9-usage: regular; kite9-type: svg; kite9-template: url(/public/examples/risk-first/redesign/decals/cross_v2.svg); ' />
  </template>

  <template id='risk-box' k9-ui="">
    <back style='kite9-usage: decal; kite9-type: svg; fill: url(#risk-background); ' k9-indicator="rect" > 
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='8px' ry='8px' class="risk-back" />
    </back>
    <svg:g class="risk">
      <contents />
    </svg:g>
  </template>

  <template id='table'>
    <back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' style='fill: white; ' />
    </back>
    <contents />
  </template>

  <template id="container">
    <back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='8px' ry='8px' class="container-back" />
    </back>
    <svg:g class="container">
      <contents />
    </svg:g>
  </template>

  <template id='code'>
    <svg:g class="code-label-front">
      <front style="kite9-type: text; ">
        <contents />
      </front>
    </svg:g>
  </template>

  <template id='title'>
    <svg:g class="title-label-front">
      <front style="kite9-type: text; ">
        <contents />
        <svg:flowRegion>          
          <svg:path d="M0,0 H100 V250 H-100 z" />        
        </svg:flowRegion> 
      </front>
    </svg:g>
  </template>

  <template id="diagram" k9-ui="drop insert layout">
    <back style='kite9-usage: decal; kite9-type: svg; fill: white; ' k9-indicator="rect">
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' class="diagram-back" />
    </back>
    <contents />
  </template>
  
  <template id="methodology" k9-ui="drag delete align connect autoconnect cascade edit" >
    <risk-box>
      <code>Method</code>
      <image>
        <svg:image x="0" y="0" width="50px" height="50px" xlink:href="/public/examples/risk-first/redesign/artifacts/methodology_v2.svg" />
      </image>
      <title>
        <contents />
      </title>
    </risk-box>
  </template>
  
  <!-- tables -->
  
  <template id="shaded">
    <back style='kite9-usage: decal; kite9-type: svg;  '>
      <svg:rect x="0" y="5px" width="#{$width}" height="#{$height - (5 ) }" style="fill: #EEEEEE;" />
    </back>
  	<contents />
  </template>

  <template id="celltext">
    <text-label style="kite9-type: text;">
      <svg:flowRegion>
        <svg:rect width="950px" height="400px" />
      </svg:flowRegion>
      <contents />
    </text-label>
  </template>
  
  <template id="bulleted" style="kite9-type: container; kite9-layout: right;" >
   	<text-label style="kite9-type: text; kite9-vertical-align: top; kite9-padding-right: 15px;">
   	  &#8226; 
   	</text-label> 
    <text-label style="kite9-type: text; kite9-vertical-align: top;">
      <svg:flowRegion>
        <svg:rect width="950px" height="400px" />
      </svg:flowRegion>
      <contents />
    </text-label>
  </template>
  
  
  
  <template id="description">
    <text-label style="kite9-type: text; kite9-padding: 0; " >
      <svg:flowRegion>
        <svg:rect width="250px" height="400px" />
      </svg:flowRegion>
      <contents />
    </text-label>
  </template>
  
  <!-- Steve McConnell Stuff -->

 
   <template id="leg">
   <back style='kite9-usage: decal; kite9-type: svg; '>
     <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' style='fill: url(#risk-background); ' class="glyph-back" />
   </back>     
   <leg-text style="kite9-type: text; kite9-padding: 10px; kite9-padding-top: 50px; text-align: middle; ">
     <contents />
   </leg-text>
  </template>
 
 <plinth id="plinth" style="kite9-type: container;">
   <back style='kite9-usage: decal; kite9-type: svg; '>
     <svg:polygon points="0, #{$height} #{$width div 2},0 #{$width}, #{$height}" style='fill: url(#risk-background); ' class="glyph-back" />
   </back>
   <plinth-text style="kite9-type: text; kite9-padding: 10px; kite9-padding-top: 15px; "><contents /></plinth-text>
 </plinth>
 
 <!-- risk matrix -->
 
 <template id="symbol">
   <svg:g transform="translate(#{../@ox  }, #{../@oy})">
    <svg:circle style="fill: #A0A0A0;  stroke: none" cx="6px" cy="6px" r="8px" />
    <svg:text x=".35px" y="1px" class="symbol-text"><contents xpath="substring(@theChar,1, 1)" type="string"/></svg:text>
   </svg:g>
  </template>
  
  <template id="box">
  	<back style='kite9-usage: decal; kite9-type: svg; '>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' class="glyph-back" />
    </back>   
    <contents />
  </template>
  
  <template id='connection-label'>
    <svg:g class="container-label-front">
      <front style="kite9-type: text; ">
        <contents />
      </front>
    </svg:g>
  </template>
  
  <template class="link invisible align" id="align-template">
      <from reference="from"></from>
      <to  reference="to"></to>
  </template>
  
  <template id="cell-template" />
  
  <link id="link-template" shape="NORMAL" style="" drawDirection="RIGHT">
      <from reference="id_9" />
      <to reference="id_10" class="arrow" />
  </link>
</svg:svg>