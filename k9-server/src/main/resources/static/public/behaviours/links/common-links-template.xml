<svg:svg xmlns:svg='http://www.w3.org/2000/svg' xmlns='http://www.kite9.org/schema/adl'>
  <svg:defs>

    <!-- Link Ends -->

    <svg:marker id="circle-start-marker" markerWidth="6" markerHeight="6" refX="3" refY="3">
      <svg:circle cx="3" cy="3" r="2" class="circle-marker"></svg:circle>
    </svg:marker>

    <svg:marker id="circle-end-marker" markerWidth="6" markerHeight="6" refX="3" refY="3">
      <svg:circle cx="3" cy="3" r="2" class="circle-marker"></svg:circle>
    </svg:marker>

    <svg:marker id="diamond-start-marker" markerWidth="8" markerHeight="6" refX="1" refY="3" orient="auto">
      <svg:polygon points="1,3 4,1 7,3 4,5" class="diamond-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="diamond-end-marker" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <svg:polygon points="1,3 4,1 7,3 4,5" class="diamond-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="open-diamond-start-marker" markerWidth="8" markerHeight="6" refX="1" refY="3" orient="auto">
      <svg:polygon points="1,3 4,1 7,3 4,5" class="open-diamond-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="open-diamond-end-marker" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
      <svg:polygon points="1,3 4,1 7,3 4,5" class="open-diamond-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="barbed-arrow-end-marker" markerWidth="7" markerHeight="7" refX="6" refY="4" orient="auto">
      <svg:path d="M2,2 L6,4 L2,6" class="barbed-arrow-marker"></svg:path>
    </svg:marker>

    <svg:marker id="barbed-arrow-start-marker" markerWidth="7" markerHeight="7" refX="2" refY="4" orient="auto">
      <svg:path d="M6,2 L2,4 L6,6" class="barbed-arrow-marker"></svg:path>
    </svg:marker>

    <svg:marker id="open-arrow-end-marker" markerWidth="7" markerHeight="7" refX="6" refY="4" orient="auto">
      <svg:polygon points="6,4 2,2 2,6" class="open-arrow-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="open-arrow-start-marker" markerWidth="7" markerHeight="7" refX="2" refY="4" orient="auto">
      <svg:polygon points="2,4 6,2 6,6" class="open-arrow-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="arrow-start-marker" markerWidth="7" markerHeight="7" refX="2" refY="4" orient="auto">
      <svg:polygon points="2,4 6,2 6,6" class="arrow-marker"></svg:polygon>
    </svg:marker>

    <svg:marker id="arrow-end-marker" markerWidth="7" markerHeight="7" refX="4" refY="4" orient="auto">
      <svg:polygon points="6,4 2,2 2,6" class="arrow-marker"></svg:polygon>
    </svg:marker>

  </svg:defs>

  <template id="background">
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg;'>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' />
    </back>
    <contents />
  </template>

  <template id="group" k9-ui="drag drop delete insert align connect layout invisible">
    <back k9-indicator="rect" style='kite9-usage: decal; kite9-type: svg;'>
      <svg:rect x='0' y='0' width='#{$width}' height='#{$height}' rx='12px' ry='12px' />
    </back>
    <contents />
  </template>

  <template id='round-terminator' k9-palette="end" k9-ui="drag end invisible label">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="rect">
      <svg:ellipse cx='6' cy='6' rx="6" ry="6" />
    </grab>
    <contents />
  </template>

  <template id='up-terminator' k9-palette="end" k9-ui="drag invisible end label">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="rect">
      <svg:polygon points="0 12, 6 0, 12 12"  />
    </grab>
    <svg:polygon points="0 12, 6 0, 12 12"  k9-indicator="rect"/>
    <contents />
  </template>
  
  <template id='down-terminator' k9-palette="end" k9-ui="drag invisible end label">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="rect">
      <svg:polygon points="0 0, 6 12, 12 0" />
    </grab>
    <svg:polygon points="0 0, 6 12, 12 0" k9-indicator="rect"/>
    <contents />
  </template>
  
  <template id='left-terminator' k9-palette="end" k9-ui="drag invisible end label">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="rect">
      <svg:polygon points="12 0, 0 6, 12 12" />
    </grab>
    <svg:polygon points="12 0, 0 6, 12 12" k9-indicator="rect" />
    <contents />
  </template>
  
  <template id='right-terminator' k9-palette="end" k9-ui="drag invisible end label">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="rect">
      <svg:polygon points="0 0, 12 6, 0 12" />
    </grab>
    <svg:polygon points="0 0, 12 6, 0 12" k9-indicator="rect"/>
    <contents />
  </template>

  <template id="basic-link" k9-ui="delete link cascade drop" k9-palette="link">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="path">
      <svg:path d="#{$path}" k9-animate="link"/>
    </grab>
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;">
      <svg:path k9-animate="link" d="#{$path}"
        style="
        marker-start: url(##{../../adl:from/@class}-start-marker); 
        marker-end: url(##{../../adl:to/@class}-end-marker);" />
    </link-body>
  </template>

  <template id="align" k9-ui="delete invisible cascade">
    <grab style="kite9-type: svg; kite9-usage: decal;" k9-ui="grab" k9-indicator="path">
      <svg:path k9-animate="link" d="#{$path}" />
    </grab>
    <contents />
    <link-body style="kite9-type: svg; kite9-usage: decal;" k9-indicator="path">
      <svg:path k9-animate="link" d="#{$path}" />
    </link-body>
  </template>
</svg:svg>